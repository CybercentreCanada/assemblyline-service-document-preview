name: DocumentPreview
version: $SERVICE_TAG
description: Use OCR to detect for signs of malicious behaviour in Office and PDF files

accepts: document/(pdf|office/.*)|image/emf
rejects: empty|metadata/.*

stage: CORE
category: Static Analysis

file_required: true
timeout: 60
disable_cache: false

enabled: true
is_external: false
licence_count: 0

submission_params:
  # Default is selected for phishing campaigns that tend to be singular-paged documents
  - name: max_pages_rendered
    type: int
    value: 1
    default: 1

heuristics:
  - heur_id: 1
    name: OCR Detection found
    description: Suspicious verbage found in OCR inspection.
    score: 0
    signature_score_map:
      macros: 100
      ransomware: 100
    filetype: "*"

docker_config:
  image: ${REGISTRY}cccs/assemblyline-service-document-preview:$SERVICE_TAG
  cpu_cores: 1
  ram_mb: 1024
