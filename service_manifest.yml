name: DocumentPreview
version: $SERVICE_TAG
description: Use OCR to detect for signs of malicious behaviour

accepts: (document/pdf|document/office/.*|image/.*)
rejects: empty|metadata/.*

stage: CORE
category: Static Analysis

file_required: true
timeout: 60
disable_cache: false

enabled: true
is_external: false
licence_count: 0

heuristics:
  - heur_id: 1
    name: Potential Ransomware
    filetype: "*"
    score: 100
    description: Ransomware verbage found in OCR inspection.
  - heur_id: 2
    name: Potential Macros
    filetype: "*"
    score: 100
    description: Macros verbage found in OCR inspection.


docker_config:
  image: cccs/assemblyline-service-document-preview:$SERVICE_TAG
  cpu_cores: 1
  ram_mb: 256
